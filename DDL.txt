SET foreign_key_checks = 0;
create table dostawcy(
                         nazwa varchar(40) not null,
                         email varchar(40),
                         id_dostawcy INT AUTO_INCREMENT,
                         constraint dostawcy_pk
                             primary key (id_dostawcy)
);
create table dzialy(
                       nazwa_dzialu varchar(30) not null,
                       id_dzialu INT AUTO_INCREMENT,
                       sklepy_id_sklepu int not null,
                       constraint dzialy_pk
                           primary key (id_dzialu)
);
create table etaty(
                      nazwa_etatu varchar(40) not null,
                      placa_min float not null,
                      placa_max float,
                      wymagana_liczba_godzin int not null,
                      constraint etaty_pk
                          primary key (nazwa_etatu)
);
create table pracownicy(
                           imie varchar(40) not null,
                           nazwisko varchar(40) not null,
                           id_pracownika INT AUTO_INCREMENT,
                           id_szefa int,
                           etaty_nazwa_etatu varchar(40) not null,
                           placa float not null,
                           zatrudniony date not null,
                           zespoly_id_zesp int,
                           sklepy_id_sklepu int not null,
                           constraint pracownicy_pk
                               primary key (id_pracownika)
);
create table produkty(
                         nazwa varchar(40) not null,
                         numer_serii INT AUTO_INCREMENT,
                         cena_bazowa float not null,
                         liczba int not null,
                         dzialy_id_dzialu int not null,
                         dostawcy_id_dostawcy int not null,
                         cena_aktualna float not null,
                         constraint produkty_pk
                             primary key (numer_serii)
);
create table promocja_produktu(
                                  produkty_numer_serii int not null,
                                  promocje_id_promocji int not null,
                                  od date not null,
                                  do date not null,
                                  constraint promocja_produktu_pk
                                      primary key (
                                                   produkty_numer_serii,
                                                   promocje_id_promocji,
                                                   od,
                                                   do
                                          )
);
create table promocje(
                         nazwa varchar(40),
                         id_promocji INT AUTO_INCREMENT,
                         wysokosc_prom float not null default 0,
                         constraint promocje_pk
                             primary key (id_promocji)
);
create table sklepy(
                       adres varchar(40) not null,
                       miasto varchar(40) not null,
                       kod_pocztowy int not null,
                       id_kierownika int,
                       id_sklepu INT AUTO_INCREMENT,
                       constraint sklepy_pk
                           primary key (id_sklepu)
);
create table sprzet_pracowniczy(
                        nazwa varchar(40) not null,
                        numer_serii INT AUTO_INCREMENT,
                        dzialy_id_dzialu int not null,
                        liczba int not null,
                        constraint sprzet_pracowniczy_pk
                           primary key (numer_serii)
);
create table zespoly(
                        nazwa_zesp varchar(40) not null,
                        id_zesp INT AUTO_INCREMENT,
                        constraint zespoly_pk
                            primary key (id_zesp)
);

alter table dzialy
    add constraint dzialy_sklepy
        foreign key (sklepy_id_sklepu)
            references sklepy (id_sklepu)
            ON UPDATE CASCADE ON DELETE CASCADE;
alter table pracownicy
    add constraint pracownicy_szef
        foreign key (id_szefa)
            references Pracownicy (id_pracownika)
            ON UPDATE CASCADE ON DELETE CASCADE;
alter table pracownicy
    add constraint pracownicy_etaty
        foreign key (etaty_nazwa_etatu)
            references Etaty (nazwa_etatu)
            ON UPDATE CASCADE ON DELETE CASCADE;
alter table pracownicy
    add constraint pracownicy_etaty
        foreign key (etaty_nazwa_etatu)
            references Etaty (nazwa_etatu)
            ON UPDATE CASCADE ON DELETE CASCADE;
alter table pracownicy
    add constraint pracownicy_sklepy
        foreign key (sklepy_id_sklepu)
            references sklepy (id_sklepu)
            ON UPDATE CASCADE ON DELETE CASCADE;
alter table pracownicy
    add constraint pracownicy_zespoly
        foreign key (zespoly_id_zesp)
            references zespoly (id_zesp)
            ON DELETE SET NULL;
alter table produkty
    add constraint produkty_dostawcy
        foreign key (dostawcy_id_dostawcy)
            references dostawcy (id_dostawcy);
alter table produkty
    add constraint produkty_dzialy
        foreign key (dzialy_id_dzialu)
            references dzialy (id_dzialu);
alter table promocja_produktu
    add constraint promocja_produktu_produkty
        foreign key (produkty_numer_serii)
            references produkty (numer_serii)
            ON UPDATE CASCADE ON DELETE CASCADE;
alter table promocja_produktu
    add constraint promocja_produktu_promocje
        foreign key (promocje_id_promocji)
            references promocje (id_promocji)
            ON UPDATE CASCADE ON DELETE CASCADE;
alter table sklepy
    add constraint sklepy_pracownicy
        foreign key (id_kierownika)
            references pracownicy (id_pracownika)
            ON DELETE SET NULL;
alter table sprzet_pracowniczy
    add constraint sprzet_pracowniczy_dzialy
        foreign key (dzialy_id_dzialu)
            references dzialy (id_dzialu);

SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE TABLE_SCHEMA = 'skm' AND CONSTRAINT_NAME='PRIMARY' AND TABLE_NAME = 'etaty';

SELECT AUTO_INCREMENT FROM INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = DATABASE() AND TABLE_NAME = 'pracownicy'